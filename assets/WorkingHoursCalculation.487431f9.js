import{a as g,c as y,x as N,m as Y,j as F,e as h,b as e,t as x,g as R,v as E,h as B,y as O,z as q,F as P,k as G,A as J,n as Q,p as I,B as L,u as k,f as X,o as Z,T as ee,s as te,d as V}from"./index.2c38728f.js";import"./HackTimer.min.640bcee2.js";import{f as C}from"./useFormatNumber.010f5aee.js";function oe(){let l=new Date,t=l.getFullYear(),a=C(l.getMonth()+1),s=C(l.getDate()),n=C(l.getHours()),b=C(l.getMinutes()),p=C(l.getSeconds());return`${t}-${a}-${s} ${n}:${b}:${p}`}function W(){let l=new Date,t=l.getFullYear(),a=C(l.getMonth()+1),s=C(l.getDate()),n=C(l.getHours()),b=C(l.getMinutes());return`${t}-${a}-${s}T${n}:${b}`}function j(l){let t=document.body,a,s;if(document.createRange&&window.getSelection){a=document.createRange(),s=window.getSelection(),s.removeAllRanges();try{a.selectNodeContents(l),s.addRange(a)}catch{a.selectNode(l),s.addRange(a)}}else t.createTextRange&&(a=t.createTextRange(),a.moveToElementText(l),a.select());document.execCommand("Copy"),document.getSelection().removeAllRanges()}const ae={key:0,class:"copyed-msg"},se={__name:"WorkingHoursCalculationNotice",props:{isShowCopyed:Boolean},setup(l){const t=l;return(a,s)=>t.isShowCopyed?(g(),y("div",ae,"\u5DF2\u8907\u88FD\u5230\u526A\u8CBC\u7C3F")):N("",!0)}};var ne="/joy-tools/assets/cuckoo-clock-trimmed.33833c85.mp3";const le={class:"container"},ie={class:"row"},re={class:"col-12"},de={class:"upper-inner"},ue={id:"js-timer",class:"timer-wrap"},ce={class:"timer-text"},me={class:"btn-wrap"},_e=["data-type"],ve=["disabled"],pe={class:"group-wrap"},fe={class:"form-group"},be=["disabled"],he={class:"text-start"},ge=e("label",{for:"is_custom_start",class:"me-2"},"\u5BA2\u88FD\u5316\u958B\u59CB\u6642\u9593",-1),ye=["disabled"],Me={class:"form-group"},$e=e("label",{for:"chk-alert-sound"},"\u5E03\u7A40\u63D0\u793A\u97F3 (\u6BCF\u5C0F\u6642\u64AD\u653E)",-1),we=e("source",{src:ne,type:"audio/mpeg"},null,-1),ke=[we],Ce={class:"form-group"},Se=e("label",{for:"chk-hour"},"\u9B54\u6CD5\u6642\u6578: \u6642\u6578\u9032\u4F4D\u70BA0.25\u7684\u500D\u6578 (\u704C\u6C3410\u5206\u9418\u4EE5\u5167)",-1),xe={class:"form-group"},De=e("label",{for:"fragmentary-mode"},"\u96F6\u788E\u6642\u9593\u6A21\u5F0F (\u9B54\u6CD5\u6642\u6578\u50C5\u97FF\u61C9\u5728\u52A0\u7E3D\u6642\u9593)",-1),Te={__name:"WorkingHoursCalculationHeader",props:Y({timerData:Object},{custom_start:{},custom_startModifiers:{},isCustomStart:{},isCustomStartModifiers:{},isFragmentaryMode:{},isFragmentaryModeModifiers:{},isAlertSound:{},isAlertSoundModifiers:{},isHoursMagic:{},isHoursMagicModifiers:{},isModalShow:{},isModalShowModifiers:{}}),emits:Y(["eventWorkRecord","eventCopyTableData"],["update:custom_start","update:isCustomStart","update:isFragmentaryMode","update:isAlertSound","update:isHoursMagic","update:isModalShow"]),setup(l,{expose:t,emit:a}){const s=l,n=a,b=F(l,"custom_start"),p=F(l,"isCustomStart"),_=F(l,"isFragmentaryMode"),m=F(l,"isAlertSound"),M=F(l,"isHoursMagic"),U=F(l,"isModalShow");let $=h(null);t({alertPlayer:$});function H(){n("eventWorkRecord")}function d(){n("eventCopyTableData")}function w(){!m.value||($.value.pause(),console.log("\u6253\u52FE"))}function r(){$.value.play(),console.log("\u8A66\u807D\u63D0\u793A\u97F3")}function D(){$.value.pause(),console.log("\u505C\u6B62\u64AD\u653E\u63D0\u793A\u97F3")}return(S,u)=>(g(),y("section",null,[e("div",le,[e("div",ie,[e("div",re,[e("div",de,[e("div",ue,[e("span",ce,x(s.timerData.timer_text),1)]),e("div",me,[e("button",{"data-type":s.timerData.timer_btn_type,onClick:u[0]||(u[0]=f=>H()),class:"text-btn"},x(s.timerData.timer_btn_text),9,_e),e("button",{class:"icon-btn add","data-bs-toggle":"modal","data-bs-target":"#staticBackdrop",disabled:s.timerData.timer_btn_type=="end",onClick:u[1]||(u[1]=f=>U.value=!0)},null,8,ve),e("button",{onClick:u[2]||(u[2]=f=>d()),class:"icon-btn copy-all","data-bs-container":"body","data-bs-toggle":"tooltip","data-bs-placement":"right",title:"\u8907\u88FD\u8868\u683C\u5230\u526A\u8CBC\u7C3F"})]),e("div",pe,[e("fieldset",fe,[R(e("input",{type:"checkbox",name:"is_custom_start",id:"is_custom_start","onUpdate:modelValue":u[3]||(u[3]=f=>p.value=f),disabled:s.timerData.timer_btn_type=="end"},null,8,be),[[E,p.value]]),e("div",he,[ge,R(e("input",{type:"datetime-local","onUpdate:modelValue":u[4]||(u[4]=f=>b.value=f),disabled:!p.value},null,8,ye),[[B,b.value]])])]),e("fieldset",Me,[R(e("input",{type:"checkbox",name:"chk-alert-sound",id:"chk-alert-sound","onUpdate:modelValue":u[5]||(u[5]=f=>m.value=f),onChange:u[6]||(u[6]=f=>w())},null,544),[[E,m.value]]),$e,e("button",{onClick:u[7]||(u[7]=f=>r()),class:"icon-btn play","data-bs-container":"body","data-bs-toggle":"tooltip","data-bs-placement":"top",title:"\u8A66\u807D"}),e("button",{onClick:u[8]||(u[8]=f=>D()),class:"icon-btn pause","data-bs-container":"body","data-bs-toggle":"tooltip","data-bs-placement":"top",title:"\u505C\u6B62\u64AD\u653E"}),e("audio",{loop:"",preload:"auto",ref_key:"alertPlayer",ref:$,class:"audio-player"},ke,512)]),e("fieldset",Ce,[R(e("input",{type:"checkbox",name:"chk-hour",id:"chk-hour","onUpdate:modelValue":u[9]||(u[9]=f=>M.value=f)},null,512),[[E,M.value]]),Se]),e("fieldset",xe,[R(e("input",{type:"checkbox",name:"fragmentary-mode",id:"fragmentary-mode","onUpdate:modelValue":u[10]||(u[10]=f=>_.value=f)},null,512),[[E,_.value]]),De])])])])])])]))}},Re={class:"container"},He={class:"row"},Fe={class:"col-12"},Ue={class:"container-inner"},Ae={class:"table-wrap"},Ne=e("thead",null,[e("th",{width:"20%"},"\u65E5\u671F"),e("th",{width:"25%"},"\u6642\u6BB5"),e("th",{width:"20%"},"\u6642\u6578"),e("th",null,"\u5099\u8A3B")],-1),Be={key:0},Ee={key:0,class:"text-magic"},Ve={key:1},Ye={class:"other-wrap"},We={class:"remark-wrap"},Pe={key:0,class:"comment-text"},je=["data-id","onUpdate:modelValue","onBlur","onKeyup"],Ie={class:"operate-wrap"},Le=["onClick"],Ke=["onClick","disabled"],ze=e("td",null,"\u7E3D\u8A08",-1),Oe=e("td",null,null,-1),qe=e("td",null,null,-1),Ge={__name:"WorkingHoursCalculationBody",props:{record_arr:Array,total_hour:Number,isFragmentaryMode:Boolean,isHoursMagic:Boolean},emits:["eventEnableComment","eventRemoveRecord","eventCopyTrData"],setup(l,{expose:t,emit:a}){const s=l,n=a;let b=h(null);t({recordTable:b});let p=[];const _=function(d){d&&p.push({id:d.getAttribute("data-id"),el:d})};O(()=>{p=[]}),q(()=>{});function m(d,w){let r=d?d.split(" ")[0].split("-"):void 0,D=d?d.split(" ")[1].split(":"):void 0;switch(w){case"yyyy":return r?r[0]:"";case"mmdd":return r?`${r[1]}/${r[2]}`:"";case"hhmm":return D?`${D[0]}:${D[1]}`:""}}function M(d){return d?d.toFixed(2):"-"}function U(d){n("eventRemoveRecord",d)}function $(d,w){n("eventEnableComment",d,w),I(()=>{!w||p.forEach(r=>{r.id==d&&r.el.focus()})})}function H(d){n("eventCopyTrData",d)}return(d,w)=>(g(),y("section",null,[e("div",Re,[e("div",He,[e("div",Fe,[e("div",Ue,[e("div",Ae,[e("table",{ref_key:"recordTable",ref:b,class:"table-body table table-hover",width:"100%"},[Ne,e("tbody",null,[(g(!0),y(P,null,G(s.record_arr,(r,D)=>(g(),y("tr",{key:D},[e("td",null,x(m(r.r_start,"mmdd")),1),e("td",null,x(m(r.r_start,"hhmm"))+"~"+x(m(r.r_end,"hhmm")),1),e("td",null,[s.isFragmentaryMode?(g(),y("span",Be,x(M(r.origin_hs)),1)):(g(),y(P,{key:1},[s.isHoursMagic?(g(),y("span",Ee,x(M(r.magic_hs)),1)):N("",!0),s.isHoursMagic?N("",!0):(g(),y("span",Ve,x(M(r.origin_hs)),1))],64))]),e("td",null,[e("div",Ye,[e("div",We,[r.comment_editable?N("",!0):(g(),y("span",Pe,x(r.r_comment),1)),r.comment_editable?R((g(),y("input",{key:1,type:"text",class:"comment-input","data-id":r.r_id,ref_for:!0,ref:_,"onUpdate:modelValue":S=>r.r_comment=S,onBlur:S=>$(r.r_id,!1),onKeyup:J(S=>$(r.r_id,!1),["enter"])},null,40,je)),[[B,r.r_comment]]):N("",!0)]),e("div",Ie,[e("button",{onClick:S=>$(r.r_id,!0),class:"icon-btn edit"},null,8,Le),e("button",{onClick:S=>U(r.r_id),disabled:r.del_btn_enable,class:"icon-btn del"},null,8,Ke),e("button",{onClick:w[0]||(w[0]=S=>H(S)),class:"icon-btn copy"})])])])]))),128)),e("tr",null,[ze,Oe,e("td",null,[e("span",{class:Q({"text-magic":s.isFragmentaryMode})},x(M(s.total_hour)),3)]),qe])])],512)])])])])])]))}},Je={class:"modal fade",id:"staticBackdrop","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},Qe={class:"modal-dialog modal-dialog-centered"},Xe={class:"modal-content"},Ze={class:"modal-header"},et=e("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"},"\u65B0\u589E\u7D00\u9304",-1),tt={class:"modal-body"},ot={class:"row mb-2"},at={class:"col-12"},st=e("label",{for:"start-time",class:"me-2"},"\u958B\u59CB\u6642\u9593",-1),nt={class:"col-12"},lt=e("label",{for:"end-time",class:"mt-2 me-2"},"\u7D50\u675F\u6642\u9593",-1),it={class:"col-12"},rt=e("label",{for:"note",class:"mt-2 me-2"},"\u5099\u8A3B\u4E8B\u9805",-1),dt={class:"modal-footer"},ut={key:0,class:"text-danger"},ct=["disabled"],mt={__name:"WorkingHoursCalculationAddModal",props:{isModalShow:{},isModalShowModifiers:{}},emits:Y(["eventAddNewRecord"],["update:isModalShow"]),setup(l,{emit:t}){const a=t,s=F(l,"isModalShow");let n=h({start:"",end:"",note:"\u81EA\u5B9A\u7FA9\u65B0\u589E\u7D00\u9304"});L(()=>{if(s.value){let p=W();n.value.start=p,n.value.end=p}});function b(){a("eventAddNewRecord",n.value)}return(p,_)=>(g(),y("div",Je,[e("div",Qe,[e("div",Xe,[e("div",Ze,[et,e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:_[0]||(_[0]=m=>s.value=!1)})]),e("div",tt,[e("div",ot,[e("div",at,[st,R(e("input",{type:"datetime-local",name:"start-time",id:"start-time","onUpdate:modelValue":_[1]||(_[1]=m=>k(n).start=m)},null,512),[[B,k(n).start]])]),e("div",nt,[lt,R(e("input",{type:"datetime-local",name:"end-time",id:"end-time","onUpdate:modelValue":_[2]||(_[2]=m=>k(n).end=m)},null,512),[[B,k(n).end]])]),e("div",it,[rt,R(e("input",{type:"text",name:"note",id:"note","onUpdate:modelValue":_[3]||(_[3]=m=>k(n).note=m)},null,512),[[B,k(n).note]])])])]),e("div",dt,[k(n).start>=k(n).end?(g(),y("span",ut,"\u958B\u59CB\u6642\u9593\u4E0D\u80FD\u5927\u65BC\u7D50\u675F\u6642\u9593")):N("",!0),e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:_[4]||(_[4]=m=>{b(),s.value=!1}),disabled:k(n).start==""||k(n).end==""||k(n).start>=k(n).end},"\u65B0\u589E ",8,ct),e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:_[5]||(_[5]=m=>s.value=!1)},"\u53D6\u6D88")])])])]))}},_t={class:"container"},vt={class:"row"},pt={class:"col-12"},ft={class:"working-hours-calculation"},yt={__name:"WorkingHoursCalculation",setup(l){const t=h([]),a=h({timer:null,timer_text:"00:00:00",timer_btn_type:"start",timer_btn_text:"Start"}),s=h(W()),n=h(!1),b=h(!1),p=h(!1),_=h(!1),m=h(!1),M=h(!1),U=X(()=>(10/60).toFixed(3)),$=h(0);L(()=>{let c=0,i=0,o=0;for(let v=0;v<t.value.length;v++)t.value[v].magic_hs&&(o+=t.value[v].magic_hs),t.value[v].origin_hs&&(i+=t.value[v].origin_hs);b.value?p.value?c=Math.ceil(i*4)/4:c=i:p.value?c=o:c=i,$.value=c});let H=h(null),d=h(null);Z(()=>{new ee(document.body,{selector:"[data-bs-toggle='tooltip']"}),I(()=>{})});function w(c){let i=new Date,o=Math.ceil((i.getTime()-c.getTime())/1e3),v=C(Math.floor(o/60/60)%24),T=C(Math.floor(o/60)%60),A=C(Math.floor(o)%60);a.value.timer_text=`${v}:${T}:${A}`,console.log(a.value.timer_text)}function r(){let c=oe(),i=a.value.timer_btn_type,o=c;if(i=="start"&&n.value)if(s.value>=W()){alert("\u5BA2\u88FD\u5316\u958B\u59CB\u6642\u9593\u8981\u5C0F\u65BC\u73FE\u5728\u6642\u9593\u5662\uFF01");return}else o=s.value.replace("T"," "),console.log("\u555F\u7528 \u5BA2\u88FD\u5316\u958B\u59CB\u6642\u9593",s.value.replace("T"," "));switch(i){case"start":w(new Date(o)),a.value.timer=setInterval(()=>{w(new Date(o)),!!_.value&&minute=="00"&&second=="00"&&(H.value.alertPlayer.play(),console.log("\u6574\u9EDE\u63D0\u793A\u97F3"))},1e3),a.value.timer_btn_text="Stop",a.value.timer_btn_type="end",t.value.push({r_id:t.value.length,r_start:o,r_end:void 0,r_comment:n.value?"\u5BA2\u88FD\u5316\u958B\u59CB\u6642\u9593":void 0,origin_hs:void 0,magic_hs:void 0,del_btn_enable:!0,comment_editable:!1});break;case"end":clearInterval(a.value.timer),a.value.timer=null,H.value.alertPlayer.pause(),console.log("\u95DC\u9589\u6574\u9EDE\u63D0\u793A\u97F3"),a.value.timer_text="00:00:00",a.value.timer_btn_text="Start",a.value.timer_btn_type="start";let v=(new Date(c).getTime()-new Date(t.value[t.value.length-1].r_start).getTime())/1e3/60/60,T=Math.ceil(v*4)/4,A=T-v<=U.value?T:v;t.value[t.value.length-1].r_end=c,t.value[t.value.length-1].del_btn_enable=!1,t.value[t.value.length-1].origin_hs=v,t.value[t.value.length-1].magic_hs=A,n.value=!1;break}}function D(c){let i=c.start.replace("T"," "),o=c.end.replace("T"," "),v=c.note,T=(new Date(o).getTime()-new Date(i).getTime())/1e3/60/60,A=Math.ceil(T*4)/4,z=A-T<=U.value?A:T;t.value.push({r_id:t.value.length,r_start:i,r_end:o,r_comment:v,origin_hs:T,magic_hs:z,del_btn_enable:!1,comment_editable:!1})}function S(c){!window.confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u7B46\u7D00\u9304\u55CE\uFF1F")||(t.value=t.value.filter(o=>o.r_id!=c))}function u(c,i){for(let o of t.value)o.r_id==c&&(o.comment_editable=i)}function f(){j(d.value.recordTable),m.value=!0,setTimeout(()=>{m.value=!1},1e3)}function K(c){let o=c.target.parentNode.parentNode.parentNode.parentNode.cloneNode(!0),v=document.createElement("table");v.append(o),document.body.append(v),j(v),m.value=!0,setTimeout(()=>{m.value=!1},1e3),v.remove()}return te(()=>{clearInterval(a.value.timer)}),(c,i)=>(g(),y("div",_t,[e("div",vt,[e("div",pt,[e("section",ft,[V(se,{isShowCopyed:m.value},null,8,["isShowCopyed"]),V(Te,{ref_key:"headerRef",ref:H,timerData:a.value,custom_start:s.value,"onUpdate:custom_start":i[0]||(i[0]=o=>s.value=o),isCustomStart:n.value,"onUpdate:isCustomStart":i[1]||(i[1]=o=>n.value=o),isFragmentaryMode:b.value,"onUpdate:isFragmentaryMode":i[2]||(i[2]=o=>b.value=o),isHoursMagic:p.value,"onUpdate:isHoursMagic":i[3]||(i[3]=o=>p.value=o),isAlertSound:_.value,"onUpdate:isAlertSound":i[4]||(i[4]=o=>_.value=o),isModalShow:M.value,"onUpdate:isModalShow":i[5]||(i[5]=o=>M.value=o),onEventWorkRecord:r,onEventCopyTableData:f},null,8,["timerData","custom_start","isCustomStart","isFragmentaryMode","isHoursMagic","isAlertSound","isModalShow"]),V(Ge,{ref_key:"bodyRef",ref:d,record_arr:t.value,total_hour:$.value,isFragmentaryMode:b.value,isHoursMagic:p.value,onEventEnableComment:u,onEventRemoveRecord:S,onEventCopyTrData:K},null,8,["record_arr","total_hour","isFragmentaryMode","isHoursMagic"]),V(mt,{isModalShow:M.value,"onUpdate:isModalShow":i[6]||(i[6]=o=>M.value=o),onEventAddNewRecord:D},null,8,["isModalShow"])])])])]))}};export{yt as default};
