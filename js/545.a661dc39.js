"use strict";(self["webpackChunkvue3_tools"]=self["webpackChunkvue3_tools"]||[]).push([[545],{8554:function(e,t,a){a.r(t),a.d(t,{default:function(){return ie}});var o=a(6768);const n={class:"container"},r={class:"row"},l={class:"col-12"},c={class:"working-hours-calculation"};function i(e,t,a,i,d,s){const u=(0,o.g2)("WorkingHoursCalculationNotice"),m=(0,o.g2)("WorkingHoursCalculationHeader"),p=(0,o.g2)("WorkingHoursCalculationBody");return(0,o.uX)(),(0,o.CE)("div",n,[(0,o.Lk)("div",r,[(0,o.Lk)("div",l,[(0,o.Lk)("section",c,[(0,o.bF)(u,{showCopyed:i.data.showCopyed},null,8,["showCopyed"]),(0,o.bF)(m,{ref:"headerRef",data:i.data,onEventWorkRecord:i.workRecord,onEventCopyTableData:i.copyTableData},null,8,["data","onEventWorkRecord","onEventCopyTableData"]),(0,o.bF)(p,{ref:"bodyRef",data:i.data,onEventEnableComment:i.enableComment,onEventRemoveRecord:i.removeRecord,onEventCopyTrData:i.copyTrData},null,8,["data","onEventEnableComment","onEventRemoveRecord","onEventCopyTrData"])])])])])}a(4114);var d=a(144),s=a(8077);function u(e){return e.toString().padStart(2,"0")}function m(){let e=new Date,t=e.getFullYear(),a=u(e.getMonth()+1),o=u(e.getDate()),n=u(e.getHours()),r=u(e.getMinutes()),l=u(e.getSeconds());return`${t}-${a}-${o} ${n}:${r}:${l}`}function p(e){let t,a,o=document.body;if(document.createRange&&window.getSelection){t=document.createRange(),a=window.getSelection(),a.removeAllRanges();try{t.selectNodeContents(e),a.addRange(t)}catch(n){t.selectNode(e),a.addRange(t)}}else o.createTextRange&&(t=o.createTextRange(),t.moveToElementText(e),t.select());document.execCommand("Copy"),document.getSelection().removeAllRanges()}const b={key:0,class:"copyed-msg"};function k(e,t,a,n,r,l){return n.isShow?((0,o.uX)(),(0,o.CE)("div",b,"已複製到剪貼簿")):(0,o.Q3)("",!0)}var _={name:"WorkingHoursCalculationNotice",props:["showCopyed"],setup(e){let t=(0,d.lW)(e,"showCopyed");return{isShow:t}}},v=a(1241);const y=(0,v.A)(_,[["render",k]]);var g=y,h=a(4232),f=a(5130),C=a.p+"media/cuckoo-clock-trimmed.faee1e2a.mp3";const L={class:"container"},w={class:"row"},D={class:"col-12"},R={class:"upper-inner"},T={id:"js-timer",class:"timer-wrap"},E={class:"timer-text"},x={class:"btn-wrap"},W=["data-type"],H={class:"group-wrap"},$={class:"form-group"},S=(0,o.Lk)("label",{for:"chk-alert-sound"},"布穀提示音 (每小時播放)",-1),X={loop:"",preload:"auto",ref:"alertPlayer",class:"audio-player"},N=(0,o.Lk)("source",{src:C,type:"audio/mpeg"},null,-1),A=[N],F={class:"form-group"},M=(0,o.Lk)("label",{for:"chk-hour"},"時數進位為0.25的倍數 (灌水10分鐘以內)",-1);function I(e,t,a,n,r,l){return(0,o.uX)(),(0,o.CE)("section",null,[(0,o.Lk)("div",L,[(0,o.Lk)("div",w,[(0,o.Lk)("div",D,[(0,o.Lk)("div",R,[(0,o.Lk)("div",T,[(0,o.Lk)("span",E,(0,h.v_)(n.initData.timer_text),1)]),(0,o.Lk)("div",x,[(0,o.Lk)("button",{"data-type":n.initData.timer_btn_type,onClick:t[0]||(t[0]=e=>n.workRecord()),class:"text-btn"},(0,h.v_)(n.initData.timer_btn_text),9,W),(0,o.Lk)("button",{onClick:t[1]||(t[1]=e=>n.copyTableData()),class:"icon-btn copy-all","data-bs-container":"body","data-bs-toggle":"tooltip","data-bs-placement":"right",title:"複製表格到剪貼簿"})]),(0,o.Lk)("div",H,[(0,o.Lk)("fieldset",$,[(0,o.bo)((0,o.Lk)("input",{type:"checkbox",name:"chk-alert-sound",id:"chk-alert-sound","onUpdate:modelValue":t[2]||(t[2]=e=>n.initData.alert_sound=e),onChange:t[3]||(t[3]=e=>n.controlPlayer())},null,544),[[f.lH,n.initData.alert_sound]]),S,(0,o.Lk)("button",{onClick:t[4]||(t[4]=e=>n.playSound()),class:"icon-btn play","data-bs-container":"body","data-bs-toggle":"tooltip","data-bs-placement":"top",title:"試聽"}),(0,o.Lk)("button",{onClick:t[5]||(t[5]=e=>n.pauseSound()),class:"icon-btn pause","data-bs-container":"body","data-bs-toggle":"tooltip","data-bs-placement":"top",title:"停止播放"}),(0,o.Lk)("audio",X,A,512)]),(0,o.Lk)("fieldset",F,[(0,o.bo)((0,o.Lk)("input",{type:"checkbox",name:"chk-hour",id:"chk-hour","onUpdate:modelValue":t[6]||(t[6]=e=>n.initData.hours_magic=e)},null,512),[[f.lH,n.initData.hours_magic]]),M])])])])])])])}var K={name:"WorkingHoursCalculationHeader",props:["data"],emits:["eventWorkRecord","eventCopyTableData"],setup(e,t){let a=(0,d.lW)(e,"data"),o=(0,d.KR)(null);function n(){t.emit("eventWorkRecord")}function r(){t.emit("eventCopyTableData")}function l(){a.value.alert_sound&&(o.value.pause(),console.log("打勾"))}function c(){o.value.play(),console.log("試聽提示音")}function i(){o.value.pause(),console.log("停止播放提示音")}return{initData:a,alertPlayer:o,workRecord:n,copyTableData:r,controlPlayer:l,playSound:c,pauseSound:i}}};const B=(0,v.A)(K,[["render",I]]);var P=B;const Q={class:"container"},V={class:"row"},U={class:"col-12"},Y={class:"container-inner"},j={class:"table-wrap"},J=(0,o.Lk)("table",{class:"table-header table table-hover",width:"100%"},[(0,o.Lk)("thead",null,[(0,o.Lk)("th",null,"日期"),(0,o.Lk)("th",null,"時段"),(0,o.Lk)("th",null,"時數"),(0,o.Lk)("th",null,"備註"),(0,o.Lk)("th",null,"操作")])],-1),q={class:"table-body table table-hover",ref:"recordTable",width:"100%"},z={key:0},G={key:1},O={key:0,class:"comment-text"},Z=["data-id","onUpdate:modelValue","onBlur"],ee=["onClick"],te=["onClick","disabled"];function ae(e,t,a,n,r,l){return(0,o.uX)(),(0,o.CE)("section",null,[(0,o.Lk)("div",Q,[(0,o.Lk)("div",V,[(0,o.Lk)("div",U,[(0,o.Lk)("div",Y,[(0,o.Lk)("div",j,[J,(0,o.Lk)("table",q,[(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.initData.record_arr,((e,a)=>((0,o.uX)(),(0,o.CE)("tr",{key:a},[(0,o.Lk)("td",null,(0,h.v_)(n.formatTableData(e,"start-date")),1),(0,o.Lk)("td",null,(0,h.v_)(n.formatTableData(e,"start-time"))+"~"+(0,h.v_)(n.formatTableData(e,"end-time")),1),(0,o.Lk)("td",null,[n.initData.hours_magic?((0,o.uX)(),(0,o.CE)("span",z,(0,h.v_)(n.formatTableData(e,"magic-hours")),1)):(0,o.Q3)("",!0),n.initData.hours_magic?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",G,(0,h.v_)(n.formatTableData(e,"real-hours")),1))]),(0,o.Lk)("td",null,[e.comment_editable?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",O,(0,h.v_)(e.r_comment),1)),e.comment_editable?(0,o.bo)(((0,o.uX)(),(0,o.CE)("input",{key:1,type:"text","data-id":e.r_id,ref_for:!0,ref:n.setItemRef,"onUpdate:modelValue":t=>e.r_comment=t,onBlur:t=>n.enableComment(e.r_id,!1)},null,40,Z)),[[f.Jo,e.r_comment]]):(0,o.Q3)("",!0)]),(0,o.Lk)("td",null,[(0,o.Lk)("button",{onClick:t=>n.enableComment(e.r_id,!0),class:"icon-btn edit"},null,8,ee),(0,o.Lk)("button",{onClick:t=>n.removeRecord(e.r_id),disabled:e.del_btn_enable,class:"icon-btn del"},null,8,te),(0,o.Lk)("button",{onClick:t[0]||(t[0]=e=>n.copyTrData(e)),class:"icon-btn copy"})])])))),128))])],512)])])])])])])}var oe={name:"WorkingHoursCalculationBody",props:["data"],emits:["eventEnableComment","eventRemoveRecord","eventCopyTrData"],setup(e,t){const a=(0,d.lW)(e,"data");let n=(0,d.KR)(null),r=[];const l=function(e){e&&r.push({id:e.getAttribute("data-id"),el:e})};function c(e,t){let a=e.r_start?e.r_start.split(" ")[0].split("-"):void 0,o=e.r_start?e.r_start.split(" ")[1].split(":"):void 0,n=e.r_end?e.r_end.split(" ")[1].split(":"):void 0,r=e.r_end?((new Date(e.r_end).getTime()-new Date(e.r_start).getTime())/1e3/60/60).toFixed(2):void 0,l=r?(Math.ceil(4*r)/4).toFixed(2):r,c=l-r<=.167?l:r;switch(t){case"start-date":return e.r_start?`${a[1]}/${a[2]}`:"";case"start-time":return e.r_start?`${o[0]}:${o[1]}`:"";case"end-time":return e.r_end?`${n[0]}:${n[1]}`:"";case"real-hours":return r||"-";case"magic-hours":return c||"-"}}function i(e){t.emit("eventRemoveRecord",e)}function s(e,a){t.emit("eventEnableComment",e,a),(0,o.dY)((()=>{a&&r.forEach((t=>{t.id==e&&t.el.focus()}))}))}function u(e){t.emit("eventCopyTrData",e)}return(0,o.Ic)((()=>{r=[]})),(0,o.$u)((()=>{})),{initData:a,recordTable:n,setItemRef:l,formatTableData:c,removeRecord:i,enableComment:s,copyTrData:u}}};const ne=(0,v.A)(oe,[["render",ae]]);var re=ne,le={name:"WorkingHoursCalculation",components:{WorkingHoursCalculationNotice:g,WorkingHoursCalculationHeader:P,WorkingHoursCalculationBody:re},setup(){let e=(0,d.Kh)({record_arr:[],timer:null,timer_text:"00:00:00",timer_btn_type:"start",timer_btn_text:"Start",hours_magic:!1,alert_sound:!1,showCopyed:!1}),t=(0,d.KR)(null),a=(0,d.KR)(null);function n(){let a=m(),o=e.timer_btn_type;switch(o){case"start":e.timer_text="00:00:01",e.timer=setInterval((()=>{let o=new Date(a),n=new Date,r=Math.ceil((n.getTime()-o.getTime())/1e3),l=u(Math.floor(r/60/60)%24),c=u(Math.floor(r/60)%60),i=u(Math.floor(r)%60);e.timer_text=`${l}:${c}:${i}`,console.log(e.timer_text),e.alert_sound&&"00"==c&&"00"==i&&(t.value.alertPlayer.play(),console.log("整點提示音"))}),1e3),e.timer_btn_text="Stop",e.timer_btn_type="end",e.record_arr.push({r_id:e.record_arr.length,r_start:a,r_end:void 0,r_comment:void 0,del_btn_enable:!0,comment_editable:!1});break;case"end":clearInterval(e.timer),e.timer=null,e.timer_text="00:00:00",e.timer_btn_text="Start",e.timer_btn_type="start",e.record_arr[e.record_arr.length-1].r_end=a,e.record_arr[e.record_arr.length-1].del_btn_enable=!1;break}}function r(t){let a=window.confirm("確定要刪除此筆紀錄嗎？");a&&(e.record_arr=e.record_arr.filter((e=>e.r_id!=t)))}function l(t,a){for(let o of e.record_arr)o.r_id==t&&(o.comment_editable=a)}function c(){p(a.value.recordTable),e.showCopyed=!0,setTimeout((()=>{e.showCopyed=!1}),1e3)}function i(t){let a=t.target.parentNode.parentNode,o=a.cloneNode(!0),n=document.createElement("table");n.append(o),document.body.append(n),p(n),e.showCopyed=!0,setTimeout((()=>{e.showCopyed=!1}),1e3),n.remove()}return(0,o.sV)((()=>{new s.m_(document.body,{selector:"[data-bs-toggle='tooltip']"}),(0,o.dY)((()=>{}))})),{data:e,headerRef:t,bodyRef:a,workRecord:n,removeRecord:r,enableComment:l,copyTableData:c,copyTrData:i}}};const ce=(0,v.A)(le,[["render",i]]);var ie=ce}}]);
//# sourceMappingURL=545.a661dc39.js.map