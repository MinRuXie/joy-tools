{"version":3,"file":"js/519.fb38f759.js","mappings":"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","sources":["webpack://vue3_tools/./src/components/works/working-hours-calculation/WorkingHoursCalculation.vue","webpack://vue3_tools/./src/hooks/useFormatNumber.js","webpack://vue3_tools/./src/hooks/useGetNowDateTimeString.js","webpack://vue3_tools/./src/hooks/useCopySelectedData.js","webpack://vue3_tools/./src/components/works/working-hours-calculation/WorkingHoursCalculationNotice.vue","webpack://vue3_tools/./src/components/works/working-hours-calculation/WorkingHoursCalculationNotice.vue?e24e","webpack://vue3_tools/./src/components/works/working-hours-calculation/WorkingHoursCalculationHeader.vue","webpack://vue3_tools/./src/components/works/working-hours-calculation/WorkingHoursCalculationHeader.vue?146d","webpack://vue3_tools/./src/components/works/working-hours-calculation/WorkingHoursCalculation.vue?b2c5"],"sourcesContent":["<template>\r\n    <section class=\"working-hours-calculation\">\r\n        \r\n        <!-- 已複製的提示訊息框 -->\r\n        <WorkingHoursCalculationNotice\r\n            :showCopyed=\"data.showCopyed\" \r\n        />\r\n\r\n        <!-- Header -->\r\n        <WorkingHoursCalculationHeader\r\n            ref=\"headerRef\"\r\n            :data=\"data\"\r\n            @eventWorkRecord=\"workRecord\"\r\n            @eventCopyTableData=\"copyTableData\"\r\n        />\r\n\r\n\r\n\r\n        <section>\r\n\r\n            <div class=\"container\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-12\">\r\n                        <div class=\"container-inner\">\r\n\r\n                            <!-- 表格 -->\r\n                            <div class=\"table-wrap\">\r\n                                <!-- 表格標題 -->\r\n                                <table class=\"table-header table table-hover\" width=\"100%\">\r\n                                    <thead>\r\n                                        <th>日期</th>\r\n                                        <th>時段</th>\r\n                                        <th>時數</th>\r\n                                        <th>備註</th>\r\n                                        <th>操作</th>\r\n                                    </thead>\r\n                                </table>\r\n                                <!-- 表格內容 (供複製) -->\r\n                                <table class=\"table-body table table-hover\" ref=\"recordTable\" width=\"100%\">\r\n                                    <tbody>\r\n\r\n                                        <tr v-for=\"(item, index) of data.record_arr\" :key=\"index\">\r\n                                            \r\n                                            <!-- 日期 -->\r\n                                            <td>{{ formatTableData(item, 'start-date') }}</td>\r\n\r\n                                            <!-- 時段 -->\r\n                                            <td>{{ formatTableData(item, 'start-time') }}~{{ formatTableData(item, 'end-time') }}</td>\r\n\r\n                                            <!-- 時數 -->\r\n                                            <td>\r\n                                                <!-- 魔法時數: 無條件進位值 -->\r\n                                                <span v-if=\"data.hours_magic\">{{ formatTableData(item, 'magic-hours') }}</span>\r\n\r\n                                                <!-- 真實時數: 原始值 -->\r\n                                                <span v-if=\"!data.hours_magic\">{{ formatTableData(item, 'real-hours') }}</span>\r\n                                            </td>\r\n\r\n                                            <!-- 備註 -->\r\n                                            <td>\r\n                                                <!-- 顯示文字 -->\r\n                                                <span v-if=\"!item.comment_editable\" class=\"comment-text\">{{ item.r_comment }}</span>\r\n                                                \r\n                                                <!-- 輸入框 -->\r\n                                                <input type=\"text\" \r\n                                                    v-if=\"item.comment_editable\" \r\n                                                    :data-id=\"item.r_id\"\r\n                                                    :ref=\"setItemRef\"\r\n                                                    v-model=\"item.r_comment\"\r\n                                                    @blur=\"enableComment(item.r_id, false)\"\r\n                                                >\r\n                                            </td>\r\n\r\n                                            <!-- 操作 -->\r\n                                            <td>\r\n                                                <!-- 編輯備註 -->\r\n                                                <button @click=\"enableComment(item.r_id, true)\" class=\"icon-btn edit\"></button>\r\n\r\n                                                <!-- 刪除紀錄 -->\r\n                                                <button @click=\"removeRecord(item.r_id)\" :disabled=\"item.del_btn_enable\" class=\"icon-btn del\"></button>\r\n\r\n                                                <!-- 複製按鈕 -->\r\n                                                <button @click=\"copyTrData($event)\" class=\"icon-btn copy\"></button>\r\n                                            </td>\r\n                                        </tr>\r\n\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        </section>\r\n\r\n    </section>\r\n</template>\r\n<script>\r\nimport { ref, reactive, onMounted, nextTick, onBeforeUpdate, onUpdated } from 'vue'\r\n\r\n// Adding Bootstrap 5 tooltip to Vue 3\r\n// https://stackoverflow.com/questions/69053972/adding-bootstrap-5-tooltip-to-vue-3\r\nimport { Tooltip } from 'bootstrap'\r\n\r\n// hooks\r\nimport { formatTwoDigits } from '@/hooks/useFormatNumber'\r\nimport useFormatNumber from '@/hooks/useGetNowDateTimeString'\r\nimport useCopySelectedData from '@/hooks/useCopySelectedData'\r\n\r\n// components\r\nimport WorkingHoursCalculationNotice from './WorkingHoursCalculationNotice.vue'\r\nimport WorkingHoursCalculationHeader from './WorkingHoursCalculationHeader.vue'\r\n\r\n\r\nexport default {\r\n    name: 'WorkingHoursCalculation',\r\n    components: {\r\n        WorkingHoursCalculationNotice,\r\n        WorkingHoursCalculationHeader,\r\n    },\r\n\r\n    setup() {\r\n        // 數據\r\n        let data = reactive({\r\n            record_arr: [], // 記錄陣列\r\n            timer: null, // 計時器\r\n            timer_text: '00:00:00', // 計時器文字\r\n            timer_btn_type: 'start', // 計時按鈕類型: 'start' | 'end'\r\n            timer_btn_text: 'Start', // 計時按鈕文字: 'Start' | 'Stop'\r\n            hours_magic: false, // 時數無條件進位開關\r\n            alert_sound: false, // 提示音開關\r\n            showCopyed: false, // 複製完成提醒訊息\r\n        })\r\n\r\n        // 靜態元素\r\n        let headerRef = ref(null)  // WorkingHoursCalculationHeader 子組件\r\n        let recordTable = ref(null)\r\n\r\n        // 獲取 v-for 產生的動態元素\r\n        // Vue.js ref inside the v-for loop\r\n        // https://stackoverflow.com/questions/52086128/vue-js-ref-inside-the-v-for-loop\r\n        let itemRefs = []\r\n        const setItemRef = function(el) {\r\n            if (el) {\r\n                itemRefs.push({\r\n                    id: el.getAttribute(\"data-id\"),\r\n                    el\r\n                })\r\n            }\r\n        }\r\n        onBeforeUpdate(() => {\r\n            itemRefs = []\r\n        })\r\n        onUpdated(() => {\r\n            // console.log(itemRefs)\r\n        })\r\n\r\n\r\n        onMounted(()=>{\r\n\r\n            // init bs5 tooltips\r\n            new Tooltip(document.body, {\r\n                selector: \"[data-bs-toggle='tooltip']\",\r\n            })\r\n\r\n            nextTick(()=>{\r\n                // do stuff with the DOM\r\n\r\n            })\r\n        })\r\n\r\n\r\n\r\n        // 方法\r\n\r\n        // 格式化表格使用的文字\r\n        function formatTableData(obj, type) {\r\n            // [yyyy, mm, dd]\r\n            let start_d_arr = obj.r_start ? (obj.r_start.split(' ')[0]).split('-') : undefined;\r\n            // let end_d_arr = obj.r_end ? (obj.r_end.split(' ')[0]).split('-') : undefined;\r\n            \r\n            // [hh, mm, ss]\r\n            let start_t_arr = obj.r_start ? (obj.r_start.split(' ')[1]).split(':') : undefined;\r\n            let end_t_arr = obj.r_end ? (obj.r_end.split(' ')[1]).split(':') : undefined;\r\n\r\n            // hs\r\n            let origin_hs = obj.r_end ? ( ( (new Date(obj.r_end)).getTime() - (new Date(obj.r_start)).getTime() ) / 1000 / 60 / 60 ).toFixed(2) : undefined; // 原始\r\n            let magic_hs = origin_hs ? (Math.ceil(origin_hs * 4) / 4).toFixed(2) : origin_hs; // 無條件進位\r\n            let magic_hs_check = (magic_hs - origin_hs) <= 0.167 ? magic_hs : origin_hs; // 10分鐘以內的誤差才進位\r\n\r\n            switch(type) {\r\n                // 開始日期\r\n                case 'start-date':\r\n                    // 日期 (yyyy-mm-dd)\r\n                    // return  obj.r_start ? obj.r_start.split(' ')[0] : '';\r\n\r\n                    // 日期 (mm/dd)\r\n                    return  obj.r_start ? `${start_d_arr[1]}/${start_d_arr[2]}` : '';\r\n\r\n                // 開始時段\r\n                case 'start-time':\r\n                    // 時段 (hh:mm:ss)\r\n                    // return  obj.r_start ? obj.r_start.split(' ')[1] : '';\r\n\r\n                    // 時段 (hh:mm)\r\n                    return  obj.r_start ? `${start_t_arr[0]}:${start_t_arr[1]}` : '';\r\n\r\n                // 結束時段\r\n                case 'end-time':\r\n                    // 時段 (hh:mm:ss)\r\n                    // return obj.r_end ? obj.r_end.split(' ')[1] : '';\r\n\r\n                    // 時段 (hh:mm)\r\n                    return obj.r_end ? `${end_t_arr[0]}:${end_t_arr[1]}` : '';\r\n\r\n                // 真實時數\r\n                case 'real-hours':\r\n                    return origin_hs ? origin_hs : '-';\r\n\r\n                // 魔法時數\r\n                case 'magic-hours':\r\n                    return  magic_hs_check ? magic_hs_check : '-';\r\n            }\r\n        }\r\n\r\n\r\n        // 計時功能 (開始 | 暫停)\r\n        function workRecord() {\r\n            let now_str = useFormatNumber();\r\n            let type = data.timer_btn_type;\r\n\r\n            switch(type) {\r\n                // 開始\r\n                case 'start':                \r\n                    // 更新計時器文字\r\n                    data.timer_text = '00:00:01';\r\n                \r\n                    // 每秒執行\r\n                    data.timer = setInterval(() => {\r\n                        let start = new Date(now_str);\r\n                        let now = new Date();\r\n                        let offsetTime = Math.ceil( (now.getTime() - start.getTime() ) / 1000 );\r\n\r\n                        // let day = formatTwoDigits( Math.floor(offsetTime / 60 / 60 / 24) );\r\n                        let hour = formatTwoDigits( Math.floor(offsetTime / 60 / 60) % 24 );\r\n                        let minute = formatTwoDigits( Math.floor(offsetTime / 60) % 60 );\r\n                        let second = formatTwoDigits( Math.floor(offsetTime) % 60 );\r\n\r\n                        // 更新計時器文字\r\n                        data.timer_text = `${hour}:${minute}:${second}`;\r\n                        console.log(data.timer_text);\r\n\r\n                        // 整點提示音\r\n                        if ( !data.alert_sound ) return;\r\n                        if ( minute == '00' && second == '00' ) {\r\n                            headerRef.value.alertPlayer.play(); // 取用子組件中的ref - 播放音檔\r\n                            console.log('整點提示音');\r\n                        }\r\n\r\n                    }, 1000);\r\n                \r\n                    // 更新按鈕資訊\r\n                    data.timer_btn_text = 'Stop';\r\n                    data.timer_btn_type = 'end';\r\n\r\n                    // 將 新記錄 加入陣列\r\n                    data.record_arr.push({\r\n                        r_id: data.record_arr.length,      // 0\r\n                        r_start: now_str,   // '2024-01-01 10:00'\r\n                        r_end: undefined,     // '2024-01-01 17:00'\r\n                        r_comment: undefined, // '備註欄位'\r\n                    \r\n                        del_btn_enable: true, // 刪除紀錄按紐\r\n                        comment_editable: false, // 備註欄位\r\n                    });\r\n\r\n                    break;\r\n                \r\n                // 結束\r\n                case 'end':\r\n                    // 清除計時器\r\n                    clearInterval(data.timer);\r\n                    data.timer = null;\r\n\r\n                    // 更新計時器文字\r\n                    data.timer_text = '00:00:00';\r\n                \r\n                    // 更新按鈕資訊\r\n                    data.timer_btn_text = 'Start';\r\n                    data.timer_btn_type = 'start';\r\n\r\n                    // 更新最後一筆紀錄\r\n                    data.record_arr[data.record_arr.length - 1].r_end = now_str;\r\n                    data.record_arr[data.record_arr.length - 1].del_btn_enable = false;\r\n\r\n                    break;\r\n            }\r\n        }\r\n\r\n        // 刪除紀錄\r\n        function removeRecord(id) {\r\n            let flag = window.confirm(`確定要刪除此筆紀錄嗎？`);\r\n            if ( !flag ) return;\r\n            data.record_arr = data.record_arr.filter((item)=> item.r_id != id );\r\n        }\r\n\r\n        // 開啟 | 關閉 備註欄位\r\n        function enableComment(id, flag) {\r\n            for (let r of data.record_arr ) {\r\n                if ( r.r_id == id ) {\r\n                    r.comment_editable = flag; // 更新資料\r\n                }\r\n            }\r\n\r\n            nextTick(()=>{\r\n                // do stuff with the DOM\r\n\r\n                // 關閉編輯模式\r\n                if ( !flag ) return;\r\n\r\n                // 尋找對應的 input 元素\r\n                itemRefs.forEach((item) => {\r\n                    if ( item.id == id ) {\r\n                        item.el.focus(); // 讓 input 取得焦點\r\n                    }\r\n                });\r\n            })\r\n        }\r\n\r\n        // 複製表格資料\r\n        function copyTableData() {           \r\n            // 複製\r\n            useCopySelectedData(recordTable.value);\r\n\r\n            // 更新資料\r\n            data.showCopyed = true;\r\n            setTimeout(()=>{\r\n                data.showCopyed = false;\r\n            }, 1000);\r\n        }\r\n\r\n        // 複製資料\r\n        function copyTrData(e) {\r\n            let tr = e.target.parentNode.parentNode;\r\n            \r\n            // 製作結構\r\n            let clone_tr = tr.cloneNode(true); // clone tr\r\n            let el = document.createElement('table');\r\n            el.append(clone_tr);\r\n            \r\n            document.body.append(el); // 插入頁面\r\n            useCopySelectedData(el); // 複製\r\n\r\n            // 更新資料\r\n            data.showCopyed = true;\r\n            setTimeout(()=>{\r\n                data.showCopyed = false;\r\n            }, 1000);\r\n\r\n            el.remove(); // 從頁面移除\r\n        }\r\n\r\n        \r\n\r\n\r\n\r\n        return {\r\n            // 數據\r\n            data,\r\n\r\n            // 元素\r\n            headerRef,\r\n            recordTable,\r\n\r\n            // 方法\r\n            setItemRef,\r\n            formatTableData,\r\n\r\n            workRecord,\r\n            removeRecord,\r\n            enableComment,\r\n            copyTableData,\r\n            copyTrData,\r\n        }\r\n    }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n\r\n</style>","\r\n// 格式化數字成兩位數 (nn)\r\nexport function formatTwoDigits(num) {\r\n    return num.toString().padStart(2, '0');\r\n}","import { formatTwoDigits } from './useFormatNumber'\r\n\r\n// 取得目前日期時間的字串 (yyyy-mm-dd hh:mm:ss)\r\nexport default function() {\r\n    let now = new Date();\r\n    let year = now.getFullYear();\r\n    let month = formatTwoDigits( now.getMonth() + 1 );\r\n    let day = formatTwoDigits( now.getDate() );\r\n    let hour = formatTwoDigits( now.getHours() );     // 0-23\r\n    let minute = formatTwoDigits( now.getMinutes() ); // 0-59\r\n    let second = formatTwoDigits( now.getSeconds() ); // 0-59\r\n\r\n    return `${year}-${month}-${day} ${hour}:${minute}:${second}`;\r\n}","// 複製選取範圍至剪貼簿\r\nexport default function(el) {\r\n    // 選取範圍\r\n    let body = document.body, range, sel;\r\n    if (document.createRange && window.getSelection) {\r\n        range = document.createRange();\r\n        sel = window.getSelection();\r\n        sel.removeAllRanges();\r\n        try {\r\n            range.selectNodeContents(el);\r\n            sel.addRange(range);\r\n        } catch (e) {\r\n            range.selectNode(el);\r\n            sel.addRange(range);\r\n        }\r\n    } else if (body.createTextRange) {\r\n        range = body.createTextRange();\r\n        range.moveToElementText(el);\r\n        range.select();\r\n    }\r\n\r\n    document.execCommand(\"Copy\"); // 複製進剪貼簿\r\n    document.getSelection().removeAllRanges(); // 取消選取\r\n}","<template>\r\n    <div v-if=\"isShow\" class=\"copyed-msg\">已複製到剪貼簿</div>\r\n</template>\r\n\r\n<script>\r\nimport { toRef } from 'vue';\r\n\r\n\r\nexport default {\r\n    name: 'WorkingHoursCalculationNotice',\r\n    props: ['showCopyed'],\r\n\r\n    setup(props) {\r\n        let isShow = toRef(props, 'showCopyed')\r\n\r\n        return {\r\n            isShow\r\n        }\r\n    }\r\n}\r\n</script>","import { render } from \"./WorkingHoursCalculationNotice.vue?vue&type=template&id=cad51e3a\"\nimport script from \"./WorkingHoursCalculationNotice.vue?vue&type=script&lang=js\"\nexport * from \"./WorkingHoursCalculationNotice.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n\r\n    <section>\r\n\r\n        <div class=\"container\">\r\n            <div class=\"row\">\r\n                <div class=\"col-12\">\r\n                    <div class=\"upper-inner\">\r\n\r\n                        <!-- 計時器 -->\r\n                        <div id=\"js-timer\" class=\"timer-wrap\">\r\n                            <span class=\"timer-text\">{{ initData.timer_text }}</span>\r\n                        </div>\r\n\r\n                        <div class=\"btn-wrap\">\r\n                            <!-- 計時按鈕 -->\r\n                            <button :data-type=\"initData.timer_btn_type\" @click=\"workRecord()\" class=\"text-btn\">{{ initData.timer_btn_text }}</button>\r\n\r\n                            <!-- 複製按鈕 -->\r\n                            <button @click=\"copyTableData()\" class=\"icon-btn copy-all\" data-bs-container=\"body\" data-bs-toggle=\"tooltip\" data-bs-placement=\"right\" title=\"複製表格到剪貼簿\"></button>\r\n                        </div>\r\n\r\n                        <div class=\"group-wrap\">\r\n                            <fieldset class=\"form-group\">\r\n                                <input type=\"checkbox\" name=\"chk-alert-sound\" id=\"chk-alert-sound\" v-model=\"initData.alert_sound\" @change=\"controlPlayer()\">\r\n                                <label for=\"chk-alert-sound\">布穀提示音 (每小時播放)</label>\r\n                                <button @click=\"playSound()\" class=\"icon-btn play\" data-bs-container=\"body\" data-bs-toggle=\"tooltip\" data-bs-placement=\"top\" title=\"試聽\"></button>\r\n                                <button @click=\"pauseSound()\" class=\"icon-btn pause\" data-bs-container=\"body\" data-bs-toggle=\"tooltip\" data-bs-placement=\"top\" title=\"停止播放\"></button>\r\n                                \r\n                                <!-- audio -->\r\n                                <audio loop preload=\"auto\" ref=\"alertPlayer\" class=\"audio-player\">\r\n                                    <source src=\"/audio/cuckoo-clock-trimmed.mp3\" type=\"audio/mpeg\">\r\n                                </audio>\r\n                            </fieldset>\r\n\r\n                            <fieldset class=\"form-group\">\r\n                                <input type=\"checkbox\" name=\"chk-hour\" id=\"chk-hour\" v-model=\"initData.hours_magic\">\r\n                                <label for=\"chk-hour\">時數進位為0.25的倍數 (灌水10分鐘以內)</label>\r\n                            </fieldset>\r\n                        </div>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        </section>\r\n\r\n</template>\r\n\r\n<script>\r\nimport { ref, toRef } from 'vue';\r\n\r\n\r\nexport default {\r\n    name: 'WorkingHoursCalculationHeader',\r\n    props: ['data'],\r\n    emits: [\r\n        'eventWorkRecord',\r\n        'eventCopyTableData',\r\n    ],\r\n    \r\n    setup(props, context) {\r\n        // props 的資料\r\n        let initData = toRef(props, 'data')\r\n\r\n        // 元素\r\n        let alertPlayer = ref(null)\r\n\r\n\r\n        // 方法\r\n\r\n        function workRecord() {\r\n            context.emit('eventWorkRecord')\r\n        }\r\n\r\n        function copyTableData() {\r\n            context.emit('eventCopyTableData')\r\n        }\r\n\r\n\r\n\r\n        // 由 Client 端觸發 audio 操控 (不然不能自動播放音檔)\r\n        function controlPlayer() {\r\n            if ( !initData.value.alert_sound ) return;\r\n            alertPlayer.value.pause();\r\n            console.log('打勾');\r\n        }\r\n\r\n        // 試聽音檔\r\n        function playSound() {\r\n            alertPlayer.value.play();\r\n            console.log('試聽提示音');\r\n        }\r\n\r\n        // 停止播放\r\n        function pauseSound() {\r\n            alertPlayer.value.pause();\r\n            console.log('停止播放提示音');\r\n        }\r\n\r\n\r\n        return {\r\n            initData,\r\n            alertPlayer,\r\n\r\n            workRecord,\r\n            copyTableData,\r\n            \r\n            controlPlayer,\r\n            playSound,\r\n            pauseSound,\r\n        }\r\n    }\r\n}\r\n</script>","import { render } from \"./WorkingHoursCalculationHeader.vue?vue&type=template&id=1f2f100f\"\nimport script from \"./WorkingHoursCalculationHeader.vue?vue&type=script&lang=js\"\nexport * from \"./WorkingHoursCalculationHeader.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./WorkingHoursCalculation.vue?vue&type=template&id=f2632782\"\nimport script from \"./WorkingHoursCalculation.vue?vue&type=script&lang=js\"\nexport * from \"./WorkingHoursCalculation.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","width","ref","key","_createElementBlock","_hoisted_1","_createVNode","_component_WorkingHoursCalculationNotice","showCopyed","$setup","data","_component_WorkingHoursCalculationHeader","onEventWorkRecord","workRecord","onEventCopyTableData","copyTableData","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_Fragment","_renderList","record_arr","item","index","_toDisplayString","formatTableData","hours_magic","_hoisted_9","_createCommentVNode","_hoisted_10","comment_editable","_hoisted_11","r_comment","type","r_id","ref_for","setItemRef","$event","onBlur","enableComment","_hoisted_12","onClick","_hoisted_13","removeRecord","disabled","del_btn_enable","_hoisted_14","_cache","copyTrData","formatTwoDigits","num","toString","padStart","now","Date","year","getFullYear","month","getMonth","day","getDate","hour","getHours","minute","getMinutes","second","getSeconds","el","range","sel","body","document","createRange","window","getSelection","removeAllRanges","selectNodeContents","addRange","e","selectNode","createTextRange","moveToElementText","select","execCommand","isShow","name","props","setup","toRef","__exports__","id","for","loop","preload","src","initData","timer_text","timer_btn_type","timer_btn_text","title","alert_sound","onChange","controlPlayer","playSound","pauseSound","_hoisted_15","_hoisted_16","emits","context","alertPlayer","emit","value","pause","console","log","play","components","WorkingHoursCalculationNotice","WorkingHoursCalculationHeader","reactive","timer","headerRef","recordTable","itemRefs","push","getAttribute","obj","start_d_arr","r_start","split","undefined","start_t_arr","end_t_arr","r_end","origin_hs","getTime","toFixed","magic_hs","Math","ceil","magic_hs_check","now_str","useFormatNumber","setInterval","start","offsetTime","floor","length","clearInterval","flag","confirm","filter","r","nextTick","forEach","focus","useCopySelectedData","setTimeout","tr","target","parentNode","clone_tr","cloneNode","createElement","append","remove","onBeforeUpdate","onUpdated","onMounted","Tooltip","selector","render"],"sourceRoot":""}